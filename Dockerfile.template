FROM balenalib/%%BALENA_MACHINE_NAME%%-dotnet

RUN apt-get update && \
    apt-get install -yq --no-install-recommends \
      build-essential \
      nodejs \
      npm \
    && apt-get clean && rm -rf /var/lib/apt/lists/*

RUN npm install --global npm@latest

RUN nodejs --version
RUN npm --version

WORKDIR /usr/src/app

COPY ./VendingMachine.csproj ./

RUN dotnet restore

COPY ./ ./

RUN dotnet publish -c Release -o /usr/bin/app

CMD ["/bin/bash"]